<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:p="http://primefaces.org/ui">
      
    <f:view contentType="text/html;charset=UTF-8" encoding="UTF-8">
    	<f:metadata>
    		<f:event type="preRenderView" listener="#{student.loadStudents()}"/>
    	</f:metadata>
        <h:head>
        	<title>QNPP Chatbot</title>
        </h:head>
		<h:body style="background-color:white; text-align:left;vertical-align:text-bottom;">
			<p:card id="chatbody" style="width:100%;margin-bottom:1%;height:500px; text-align:left;padding-left:10px" >					
				<f:facet name="title">
			        QNPP Chatbot
			    </f:facet>
			    <hr/>
			    				

	       </p:card>
	       <p:inputText id="input" required="true" style="width:91%;margin-left:0%;box-shadow:0.2px 0.2px 0.4px 0.4px;margin-right:1%;position:left" p:placeholder="Type up a request..."/>
		   <p:commandButton id="sendbutton" value="Send" style="background-color:blue;position:right;" icon="pi pi-arrow-right" onclick="clearAndShow()"/>
	       </h:body>
		    <script type="text/javascript" >
			    document.getElementById('input')
			    .addEventListener('keyup', function(event) {
			        if (event.code === 'Enter')
			        {
			            event.preventDefault();
			           clearAndShow();
			        }
			    });
		    	document.getElementById("chatbody").innerHTML += "Chatbot: Hello, I am the QNPP Chatbot, would you like to create, update, delete, or show a record?"
				var Input  = document.getElementById("input");
				var messageBox  = document.getElementById("chatbody");
				function clearAndShow () {
					if(input.value != ""){
						messageBox.innerHTML += "<br/>You: " +  input.value;
					}
					if(input.value.toLowerCase().includes("create")){
					    messageBox.innerHTML += "<br/>Chatbot: I shall redirect you so you can create a new record!";
					    setTimeout(function(){window.location.replace("createOperation.xhtml")}, 2300);
					}
					else if(input.value.toLowerCase().includes("update")){
					    messageBox.innerHTML += "<br/>Chatbot: I shall redirect you so you can update a record!";
					    setTimeout(function(){window.location.replace("updateOperation.xhtml")}, 2300);
					}
					else if(input.value.toLowerCase().includes("delete")){
					    messageBox.innerHTML += "<br/>Chatbot: I shall redirect you so you can delete a record!";
					    setTimeout(function(){window.location.replace("deleteOperation.xhtml")}, 2300);
					}
					else if(input.value.toLowerCase().includes("show") || input.value.toLowerCase().includes("see")){
					    messageBox.innerHTML += "<br/>Chatbot: I shall redirect you to the records page!";
					    setTimeout(function(){window.location.replace("showRecords.xhtml")}, 2300);
					}
					else if(input.value.toLowerCase().includes("hello") || input.value.toLowerCase().includes("hi")){
					    messageBox.innerHTML += "<br/>Chatbot: Hi!";
					}
					else{
					    messageBox.innerHTML += "<br/>Chatbot: Please indicate whether you want to create, delete, update, or show the records?";
					}
					input.value = "";
				}
			</script>
    </f:view>
</html>
